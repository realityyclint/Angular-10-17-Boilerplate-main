{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../_services/employee.service\";\nimport * as i2 from \"../_services/user.service\";\nimport * as i3 from \"../_services/department.service\";\nimport * as i4 from \"../_services/account.service\";\nimport * as i5 from \"../_services/alert.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/forms\";\nfunction AddEditComponent_div_0_ng_container_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 25);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementStart(3, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function AddEditComponent_div_0_ng_container_10_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.alertService.clear());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const alert_r6 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMapInterpolate1(\"alert alert-\", alert_r6.type, \" alert-dismissible fade show\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", alert_r6.message, \" \");\n  }\n}\nfunction AddEditComponent_div_0_ng_container_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"input\", 26);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", ctx_r2.getAccountEmail(ctx_r2.employee.accountId));\n  }\n}\nfunction AddEditComponent_div_0_ng_template_16_option_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const acc_r10 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", acc_r10.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(acc_r10.email);\n  }\n}\nfunction AddEditComponent_div_0_ng_template_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"select\", 16);\n    i0.ɵɵlistener(\"ngModelChange\", function AddEditComponent_div_0_ng_template_16_Template_select_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.employee.accountId = $event);\n    });\n    i0.ɵɵtemplate(1, AddEditComponent_div_0_ng_template_16_option_1_Template, 2, 2, \"option\", 17);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r4.employee.accountId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.accounts);\n  }\n}\nfunction AddEditComponent_div_0_option_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const dept_r13 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", dept_r13.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(dept_r13.name);\n  }\n}\nfunction AddEditComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelement(1, \"div\", 2);\n    i0.ɵɵelementStart(2, \"div\", 3)(3, \"div\", 4)(4, \"div\", 5)(5, \"div\", 6)(6, \"h5\", 7);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function AddEditComponent_div_0_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.cancel());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 9);\n    i0.ɵɵtemplate(10, AddEditComponent_div_0_ng_container_10_Template, 4, 4, \"ng-container\", 10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementStart(12, \"div\", 11)(13, \"label\", 12);\n    i0.ɵɵtext(14, \"Account\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(15, AddEditComponent_div_0_ng_container_15_Template, 2, 1, \"ng-container\", 13);\n    i0.ɵɵtemplate(16, AddEditComponent_div_0_ng_template_16_Template, 2, 2, \"ng-template\", null, 14, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"div\", 11)(19, \"label\", 12);\n    i0.ɵɵtext(20, \"Position\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"input\", 15);\n    i0.ɵɵlistener(\"ngModelChange\", function AddEditComponent_div_0_Template_input_ngModelChange_21_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.employee.position = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(22, \"div\", 11)(23, \"label\", 12);\n    i0.ɵɵtext(24, \"Department\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"select\", 16);\n    i0.ɵɵlistener(\"ngModelChange\", function AddEditComponent_div_0_Template_select_ngModelChange_25_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.employee.departmentId = $event);\n    });\n    i0.ɵɵtemplate(26, AddEditComponent_div_0_option_26_Template, 2, 2, \"option\", 17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(27, \"div\", 11)(28, \"label\", 12);\n    i0.ɵɵtext(29, \"Hire Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"input\", 18);\n    i0.ɵɵlistener(\"ngModelChange\", function AddEditComponent_div_0_Template_input_ngModelChange_30_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.employee.hireDate = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(31, \"div\", 19)(32, \"label\", 12);\n    i0.ɵɵtext(33, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"select\", 16);\n    i0.ɵɵlistener(\"ngModelChange\", function AddEditComponent_div_0_Template_select_ngModelChange_34_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.employee.status = $event);\n    });\n    i0.ɵɵelementStart(35, \"option\");\n    i0.ɵɵtext(36, \"Active\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(37, \"option\");\n    i0.ɵɵtext(38, \"Inactive\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(39, \"div\", 20)(40, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function AddEditComponent_div_0_Template_button_click_40_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.save());\n    });\n    i0.ɵɵelement(41, \"i\", 22);\n    i0.ɵɵtext(42, \" Save \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(43, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function AddEditComponent_div_0_Template_button_click_43_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.cancel());\n    });\n    i0.ɵɵelement(44, \"i\", 24);\n    i0.ɵɵtext(45, \" Cancel \");\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const _r3 = i0.ɵɵreference(17);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.id ? \"Edit\" : \"Add\", \" Employee \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(11, 9, ctx_r0.alertService.alert));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.id)(\"ngIfElse\", _r3);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.employee.position);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.employee.departmentId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.departments);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.employee.hireDate);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.employee.status);\n  }\n}\nexport let AddEditComponent = /*#__PURE__*/(() => {\n  class AddEditComponent {\n    constructor(employeeService, userService, departmentService, accountService, alertService) {\n      this.employeeService = employeeService;\n      this.userService = userService;\n      this.departmentService = departmentService;\n      this.accountService = accountService;\n      this.alertService = alertService;\n      this.showModal = false;\n      this.selectedEmployee = null;\n      this.cancelEvent = new EventEmitter();\n      this.saveEvent = new EventEmitter();\n      this.employee = {\n        employeeId: '',\n        accountId: '',\n        userId: '',\n        position: '',\n        departmentId: '',\n        hireDate: '',\n        status: 'Active'\n      };\n      this.isNew = true;\n      this.users = [];\n      this.departments = [];\n      this.accounts = [];\n      this.loading = false;\n    }\n    ngOnChanges(changes) {\n      if (changes['selectedEmployee']) {\n        this.isNew = !this.selectedEmployee;\n        this.employee = this.selectedEmployee ? Object.assign(Object.assign({}, this.selectedEmployee), {\n          hireDate: this.formatDate(this.selectedEmployee.hireDate)\n        }) : {\n          employeeId: '',\n          accountId: '',\n          userId: '',\n          position: '',\n          departmentId: '',\n          hireDate: '',\n          status: 'Active'\n        };\n        this.loadDropdowns();\n      }\n    }\n    loadDropdowns() {\n      this.userService.getAll().subscribe(users => this.users = users);\n      this.departmentService.getAll().subscribe(depts => this.departments = depts);\n      this.accountService.getAll().subscribe(accs => {\n        this.employeeService.getAll().subscribe(emps => {\n          const usedAccountIds = emps.map(e => e.accountId);\n          this.accounts = this.isNew ? accs.filter(acc => !usedAccountIds.includes(acc.id)) : accs;\n        });\n      });\n    }\n    save() {\n      this.alertService.clear();\n      this.loading = true;\n      const request = this.isNew ? this.employeeService.create(this.employee) : this.employeeService.update(this.employee.id, this.employee);\n      request.subscribe({\n        next: () => {\n          const msg = this.isNew ? 'Employee created successfully' : 'Employee updated successfully';\n          this.alertService.success(msg);\n          this.saveEvent.emit();\n          this.loading = false;\n        },\n        error: err => {\n          this.alertService.error(err.message);\n          this.loading = false;\n        }\n      });\n    }\n    cancel() {\n      this.alertService.clear();\n      this.cancelEvent.emit();\n    }\n    getAccountEmail(accountId) {\n      const account = this.accounts.find(acc => acc.id === accountId);\n      return account ? account.email : '';\n    }\n    formatDate(date) {\n      return date ? new Date(date).toISOString().split('T')[0] : '';\n    }\n  }\n  AddEditComponent.ɵfac = function AddEditComponent_Factory(t) {\n    return new (t || AddEditComponent)(i0.ɵɵdirectiveInject(i1.EmployeeService), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i3.DepartmentService), i0.ɵɵdirectiveInject(i4.AccountService), i0.ɵɵdirectiveInject(i5.AlertService));\n  };\n  AddEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddEditComponent,\n    selectors: [[\"app-employee-modal\"]],\n    inputs: {\n      showModal: \"showModal\",\n      selectedEmployee: \"selectedEmployee\"\n    },\n    outputs: {\n      cancelEvent: \"cancelEvent\",\n      saveEvent: \"saveEvent\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"modal-backdrop-wrapper\", 4, \"ngIf\"], [1, \"modal-backdrop-wrapper\"], [1, \"custom-backdrop\"], [\"tabindex\", \"-1\", \"role\", \"dialog\", \"aria-modal\", \"true\", \"aria-labelledby\", \"employeeModalLabel\", 1, \"modal\", \"fade\", \"show\", \"d-block\"], [\"role\", \"document\", 1, \"modal-dialog\", \"modal-dialog-centered\"], [1, \"modal-content\", \"rounded-4\", \"shadow\"], [1, \"modal-header\", \"bg-primary\", \"text-white\", \"rounded-top-4\"], [\"id\", \"employeeModalLabel\", 1, \"modal-title\", \"fw-semibold\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"btn-close\", 3, \"click\"], [1, \"modal-body\", \"bg-light\", \"p-4\"], [4, \"ngIf\"], [1, \"mb-3\"], [1, \"form-label\", \"fw-semibold\"], [4, \"ngIf\", \"ngIfElse\"], [\"selectAccount\", \"\"], [\"type\", \"text\", 1, \"form-control\", \"rounded-3\", \"shadow-sm\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-select\", \"rounded-3\", \"shadow-sm\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"date\", \"disabled\", \"\", 1, \"form-control\", \"rounded-3\", \"shadow-sm\", 3, \"ngModel\", \"ngModelChange\"], [1, \"mb-4\"], [1, \"modal-footer\"], [1, \"btn\", \"btn-success\", \"fw-semibold\", \"px-4\", \"shadow-sm\", 3, \"click\"], [1, \"bi\", \"bi-check-circle\", \"me-1\"], [1, \"btn\", \"btn-outline-secondary\", \"fw-semibold\", \"px-4\", \"shadow-sm\", 3, \"click\"], [1, \"bi\", \"bi-x-circle\", \"me-1\"], [\"role\", \"alert\"], [\"type\", \"text\", \"disabled\", \"\", 1, \"form-control\", \"rounded-3\", \"shadow-sm\", 3, \"value\"], [3, \"value\"]],\n    template: function AddEditComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, AddEditComponent_div_0_Template, 46, 11, \"div\", 0);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.showModal);\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i7.NgSelectOption, i7.ɵNgSelectMultipleOption, i7.DefaultValueAccessor, i7.SelectControlValueAccessor, i7.NgControlStatus, i7.NgModel, i6.AsyncPipe],\n    encapsulation: 2\n  });\n  return AddEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}